# Lab 2

## Завдання на роботу

**Розробити програму, яка виконує наступне:**

1. Отримує текстове представлення мережевої адреси або мережеве ім’я та/або текстове
представлення номера порту або ім’я сервісу в аргументах командного рядка. Програма
повинна підтримувати аргумент, який дозволяє вказувати тільки текстові представлення
мережевих адрес та номерів портів. Також має бути аргумент для вказування версії IP.

2. Конвертує отриманні дані в структури адрес сокетів.

3. Виводить текстове представлення отриманих структур адрес сокетів. Інформацію про
протокол треба виводити в числовому значення та іменем. Має бути аргумент командного
рядка, який вказує виводити відповідне мережеве ім’я для мережевої адреси, та аргумент,
який вказує виводити ім’я сервісу для номера порту.

## Код прогарми

[lab.2](../lab2.c)

## Опис програми

Програма представляє собою консольну утиліту для роботи з IP-адресами, доменними іменами, портами та сервісами. Вона дозволяє конвертувати між різними форматами мережевих адрес та отримувати додаткову інформацію про них.
Основні можливості програми:

- Конвертація між IP-адресами та доменними іменами
- Конвертація між номерами портів та іменами сервісів
- Підтримка як IPv4, так і IPv6 адрес
- Отримання додаткової інформації про протоколи та типи сокетів

**Аргументи командного рядка:**
<br>-a - IP-адреса або ім'я хоста для обробки (обов'язковий параметр)
<br>-p - номер порту або ім'я сервісу для обробки (обов'язковий параметр)
<br>-t - заборона використання доменних імен та імен сервісів (лише числові значення)
<br>-v - вказівка конкретної версії IP (4 для IPv4 або 6 для IPv6)
<br>-d - виведення доменного імені для вказаної IP-адреси
<br>-s - виведення імені сервісу для вказаного порту

**Алгоритм роботи програми:**

1. Обробка аргументів командного рядка за допомогою getopt()
2. Перевірка наявності обов'язкових аргументів та їх валідність
3. Налаштування структури addrinfo відповідно до заданих параметрів
4. Виклик функції getaddrinfo() для отримання інформації про адресу та порт
5. Ітерація по результатах і виведення детальної інформації для кожної знайденої адреси:
   - IP-адреса (IPv4 або IPv6)
   - Номер порту
    - Інформація про протокол
    - Доменне ім'я (якщо запитано через -d)
   - Ім'я сервісу (якщо запитано через -s)
    - Тип сокету


##  Приклади використання програми

### Приклад 1: Базове використання

```bash
$ ./lab2.out -a google.com -p 80
Results for google.com:80
------------------------
IPv4 Address: 142.250.186.206
Port: 80
Protocol: 6 (tcp)
Socket type: SOCK_STREAM
------------------------
IPv6 Address: 2a00:1450:401b:80e::200e
Port: 80
Protocol: 6 (tcp)
Socket type: SOCK_STREAM
------------------------
```

Ця команда перетворить доменне ім'я "google.com" на відповідну IP-адресу та відобразить інформацію про порт 80. Програма покаже всі знайдені IP-адреси (як IPv4, так і IPv6), їхні номери портів, протоколи та типи сокетів.

### Приклад 2: Використання з отриманням доменного імені та сервісу

```bash
$ ./lab2.out -a 8.8.8.8 -p 53 -d -s
Results for 8.8.8.8:53
------------------------
IPv4 Address: 8.8.8.8
Port: 53
Protocol: 6 (tcp)
Hostname: dns.google
Service: domain
Socket type: SOCK_STREAM
------------------------
```

У цьому випадку програма працює з IP-адресою 8.8.8.8 (публічний DNS-сервер Google) та портом 53 (стандартний порт DNS).
Прапорець -d запускає зворотний DNS-пошук, намагаючись знайти доменне ім'я, пов'язане з цією IP-адресою. Це корисно для ідентифікації серверів за їхніми IP-адресами.
Прапорець -s змушує програму шукати назву сервісу, пов'язаного з портом 53. У результаті ви побачите, що цей порт використовується для сервісу DNS (Domain Name System).

### Приклад 3: Використання лише числових значень

```bash
./lab2.out -a 192.168.1.1 -p 22 -t 
Results for 192.168.1.1:22
------------------------
IPv4 Address: 192.168.1.1
Port: 22
Protocol: 6 (tcp)
Socket type: SOCK_STREAM
------------------------

$ ./lab2.out -a 192.168.1.1 -p ssh -t 
Error: With -t, the argument for -p must be a numeric port number.
```

Прапорець -t обмежує програму використанням лише числових значень. Це означає, що програма не спробує розв'язати доменні імена або назви сервісів. Вона працюватиме безпосередньо з IP-адресою 192.168.1.1 та портом 22 (SSH).

### Приклад 4: Використання лише IPv4

```bash
$ ./lab2.out -a example.com -p 443 -v 4
Results for example.com:443
------------------------
IPv4 Address: 23.192.228.80
Port: 443
Protocol: 6 (tcp)
Socket type: SOCK_STREAM
------------------------
IPv4 Address: 96.7.128.198
Port: 443
Protocol: 6 (tcp)
Socket type: SOCK_STREAM
------------------------
IPv4 Address: 23.192.228.84
Port: 443
Protocol: 6 (tcp)
Socket type: SOCK_STREAM
------------------------
IPv4 Address: 96.7.128.175
Port: 443
Protocol: 6 (tcp)
Socket type: SOCK_STREAM
------------------------
IPv4 Address: 23.215.0.136
Port: 443
Protocol: 6 (tcp)
Socket type: SOCK_STREAM
------------------------
IPv4 Address: 23.215.0.138
Port: 443
Protocol: 6 (tcp)
Socket type: SOCK_STREAM
------------------------
```

Прапорець -v 4 вказує програмі шукати лише IPv4-адреси для доменного імені "example.com". Програма ігноруватиме будь-які IPv6-адреси, навіть якщо вони доступні для цього домену.

### Приклад 5: Використання з ім'ям сервісу замість номера порту

```bash
$ ./lab2.out -a github.com -p https
Results for github.com:https
------------------------
IPv4 Address: 140.82.121.4
Port: 443
Protocol: 6 (tcp)
Socket type: SOCK_STREAM
------------------------
```

У цьому прикладі замість конкретного номера порту використовується ім'я сервісу "https". Програма автоматично перетворить його на відповідний номер порту (443) завдяки використанню системних файлів, таких як /etc/services, які зіставляють імена сервісів із номерами портів.

### Приклад 6: Повний приклад з усіма доступними опціями

```bash
$ ./lab2.out -a stackoverflow.com -p 443 -v 4 -d -s
Results for stackoverflow.com:443
------------------------
IPv4 Address: 104.18.32.7
Port: 443
Protocol: 6 (tcp)
Hostname: 104.18.32.7
Service: https
Socket type: SOCK_STREAM
------------------------
IPv4 Address: 172.64.155.249
Port: 443
Protocol: 6 (tcp)
Hostname: 172.64.155.249
Service: https
Socket type: SOCK_STREAM
------------------------
```

Цей повний приклад демонструє використання багатьох прапорців одночасно:
<br>-a stackoverflow.com: перетворення доменного імені на IP
<br>-p 443: використання порту 443 (HTTPS)
<br>-v 4: обмеження результатів лише IPv4-адресами
<br>-d: виконання зворотного DNS-пошуку
<br>-s: пошук назви сервісу для порту 443